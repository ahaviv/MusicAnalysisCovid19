import requests
import re
import csv

url_dates = ['21022019', '28022019', '07032019', '14032019', '21032019', '28032019', '04042019', '11042019', '18042019',
             '16052019', '23052019', '30052019', '06062019', '13062019', '20062019', '27062019', '04072019', '11072019',
             '18072019', '25072019', '01082019', '08082019', '15082019', '22082019', '29082019', '05092019', '12092019',
             '19092019', '03102019', '10102019', '17102019', '24102019', '07112019', '14112019', '21112019', '28112019',
             '5122019', '12122019', '19122019', '212020', '912020', '1612020', '2312020', '2020-301', '2020-062',
             '1322020', '2022020', '2722020', '532020', '1232020', '1932020', '2632020', '242020', '1642020-1',
             '2342020', '30042020', '2020-75', '2020-145', '2020-215', '2020-46', '2020-116', '2020-186', '2020-286',
             '2020-97', '2020-167', '2020-237', '2020-208', '2020-278', '2020-39', '2020-249', '2020-110', '2020-810',
             '2020-2210', '2020-511', '2020-1911', '2020-2611', '031220', '2020-1712', '2020-2412', '712021', '1412021',
             '2112021', '2812021', '11022021', '18022021', '25022021']
dates = ['2019-02-21', '2019-02-28', '2019-03-07', '2019-03-14', '2019-03-21', '2019-03-28', '2019-04-04', '2019-04-11',
         '2019-04-18', '2019-05-16', '2019-05-23', '2019-05-30', '2019-06-06', '2019-06-13', '2019-06-20', '2019-06-27',
         '2019-07-04', '2019-07-11', '2019-07-18', '2019-07-25', '2019-08-01', '2019-08-08', '2019-08-15', '2019-08-22',
         '2019-08-29', '2019-09-05', '2019-09-12', '2019-09-19', '2019-10-03', '2019-10-10', '2019-10-17', '2019-10-24',
         '2019-11-07', '2019-11-14', '2019-11-21', '2019-11-28', '2019-12-5', '2019-12-12', '2019-12-19', '2020-1-2',
         '2020-1-9', '2020-1-16', '2020-1-23', '2020-1-30', '2020-2-6', '2020-2-13', '2020-2-20', '2020-2-27',
         '2020-3-5', '2020-3-12', '2020-3-19', '2020-3-26', '2020-4-2', '2020-4-16', '2020-4-23', '2020-4-30',
         '2020-5-7', '2020-5-14', '2020-5-21', '2020-6-4', '2020-6-11', '2020-6-18', '2020-6-28', '2020-7-9',
         '2020-7-16', '2020-7-23', '2020-8-20', '2020-8-27', '2020-9-3', '2020-9-24', '2020-10-1', '2020-10-8',
         '2020-10-22', '2020-11-5', '2020-11-19', '2020-11-26', '2020-12-03', '2020-12-17', '2020-12-24', '2021-1-7',
         '2021-1-14', '2021-1-21', '2021-1-28', '2021-02-11', '2021-02-18', '2021-02-25']

for i in range(len(url_dates)):
    url = 'https://glz.co.il/umbraco/api/article/getarticle?urlname=%D7%94%D7%9E%D7%A6%D7%A2%D7%93-%D7%94%D7%A9%D7%91%D7%95%D7%A2%D7%99-' + \
          url_dates[i] + '&rootId=1920'
html = requests.get(url, headers={'User-Agent': 'PostmanRuntime/7.26.8'})

song_list = html.json()['text']


song_list = re.sub(r'\<(.*?)\>', '', song_list)
print(song_list)
song_list = re.sub('\r', '', song_list)
song_list = re.sub('\â€“', '-', song_list)
song_list = re.sub('\xa0', '', song_list)
song_list = re.split('\n', song_list)
print(song_list)
for song in song_list:
    if song != "":
        song_fields = re.split(' \- ', song)
        print(song_fields)

with open('songs_utf8.csv', 'w', encoding='utf8', newline='') as output_file:
    fc = csv.DictWriter(output_file, fieldnames=song_list[0].keys(), )
    fc.writeheader()
    fc.writerows(song_list)
